"use strict";(self.webpackChunkhpc_wiki=self.webpackChunkhpc_wiki||[]).push([[9278],{312:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>t,metadata:()=>o,toc:()=>c});var a=i(7624),r=i(4552);const t={sidebar_position:4,sidebar_label:"Apptainer (Singularity)",hide_table_of_contents:!0,hide_title:!0,pagination_next:null,pagination_prev:null,title:"Apptainer (Singularity)",draft:!1},s=void 0,o={id:"faq/software/apptainer",title:"Apptainer (Singularity)",description:"Apptainer (Singularity)",source:"@site/docs/faq/software/apptainer.md",sourceDirName:"faq/software",slug:"/faq/software/apptainer",permalink:"/docs/faq/software/apptainer",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,sidebar_label:"Apptainer (Singularity)",hide_table_of_contents:!0,hide_title:!0,pagination_next:null,pagination_prev:null,title:"Apptainer (Singularity)",draft:!1},sidebar:"FAQ"},l={},c=[{value:"Apptainer (Singularity)",id:"apptainer-singularity",level:2},{value:"What is Apptainer?",id:"what-is-apptainer",level:3},{value:"Why should I use Apptainer?",id:"why-should-i-use-apptainer",level:3},{value:"I have scripts written for <code>singularity</code>. Can I use them with <code>apptainer</code>?",id:"i-have-scripts-written-for-singularity-can-i-use-them-with-apptainer",level:3},{value:"How do I pull an Apptainer image?",id:"how-do-i-pull-an-apptainer-image",level:3},{value:"How do I open a shell in an Apptainer container?",id:"how-do-i-open-a-shell-in-an-apptainer-container",level:3},{value:"How can I run <code>apptainer</code> in my SLURM job script?",id:"how-can-i-run-apptainer-in-my-slurm-job-script",level:3},{value:"How can I use a GPU in an Apptainer container?",id:"how-can-i-use-a-gpu-in-an-apptainer-container",level:3},{value:"What are some recommended registry websites supporting Apptainer?",id:"what-are-some-recommended-registry-websites-supporting-apptainer",level:3}];function p(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.M)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"apptainer-singularity",children:"Apptainer (Singularity)"}),"\n",(0,a.jsx)(n.h3,{id:"what-is-apptainer",children:"What is Apptainer?"}),"\n",(0,a.jsx)(n.p,{children:"Apptainer (formerly known as Singularity) is a container technology that allows you to run complex scientific applications. It is an alternative to Docker, but built and optimised for running on a HPC cluster."}),"\n",(0,a.jsx)(n.h3,{id:"why-should-i-use-apptainer",children:"Why should I use Apptainer?"}),"\n",(0,a.jsx)(n.p,{children:"Apptainer provides several advantages over Docker and other container technologies:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"It provides verifiable reproducibility of your scientific applications. In many HPC conferences such as Supercomputing Conference (SC), users are required to provide reproducible results. This can be achieved by using Apptainer."}),"\n",(0,a.jsx)(n.li,{children:"It readily integrates with HPC infrastructure, such as SLURM, GPUs, high speed Mellanox IB, parallel file system Lustre, etc."}),"\n",(0,a.jsx)(n.li,{children:"The container image format SIF is designed to be portable across different HPC systems."}),"\n"]}),"\n",(0,a.jsxs)(n.h3,{id:"i-have-scripts-written-for-singularity-can-i-use-them-with-apptainer",children:["I have scripts written for ",(0,a.jsx)(n.code,{children:"singularity"}),". Can I use them with ",(0,a.jsx)(n.code,{children:"apptainer"}),"?"]}),"\n",(0,a.jsxs)(n.p,{children:["Yes, you can use the same scripts written for ",(0,a.jsx)(n.code,{children:"singularity"})," with ",(0,a.jsx)(n.code,{children:"apptainer"}),". However, we recommend you to slowly migrate to ",(0,a.jsx)(n.code,{children:"apptainer"}),"."]}),"\n",(0,a.jsx)(n.h3,{id:"how-do-i-pull-an-apptainer-image",children:"How do I pull an Apptainer image?"}),"\n",(0,a.jsxs)(n.p,{children:["To pull an Apptainer image, you can use the ",(0,a.jsx)(n.code,{children:"apptainer pull"})," command. For example, to pull the latest version of Alpine Linux, type:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"$ apptainer pull docker://alpine\n"})}),"\n",(0,a.jsx)(n.p,{children:"You should see output like this:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"INFO:    Converting OCI blobs to SIF format\nINFO:    Starting build...\nGetting image source signatures\nCopying blob 2408cc74d12b done  \nCopying config a366738a18 done  \nWriting manifest to image destination\nStoring signatures\n2022/05/24 14:20:38  info unpack layer: sha256:2408cc74d12b6cd092bb8b516ba7d5e290f485d3eb9672efc00f0583730179e8\nINFO:    Creating SIF file...\n"})}),"\n",(0,a.jsxs)(n.p,{children:["A file called ",(0,a.jsx)(n.code,{children:"alpine_latest.sif"})," should now be in your current directory."]}),"\n",(0,a.jsx)(n.h3,{id:"how-do-i-open-a-shell-in-an-apptainer-container",children:"How do I open a shell in an Apptainer container?"}),"\n",(0,a.jsxs)(n.p,{children:["If you have a ",(0,a.jsx)(n.code,{children:".sif"})," file in your current directory, you can open a shell in the container using ",(0,a.jsx)(n.code,{children:"apptainer shell"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["For example, if you have a ",(0,a.jsx)(n.code,{children:"alpine_latest.sif"})," file in your current directory, you can open a shell in the container using:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"$ apptainer shell alpine_latest.sif\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"how-can-i-run-apptainer-in-my-slurm-job-script",children:["How can I run ",(0,a.jsx)(n.code,{children:"apptainer"})," in my SLURM job script?"]}),"\n",(0,a.jsxs)(n.p,{children:["Please find a sample SLURM job script running a container called ",(0,a.jsx)(n.code,{children:"gromacs_latest.sif"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n#SBATCH -p compute\n#SBATCH -N 1\n#SBATCH -n 4\n#SBATCH --mem 512M\n#SBATCH -t 4-2:23 # time (D-HH:MM)\n#SBATCH --job-name="hello_test"\n#SBATCH -o slurm.%j.out\n#SBATCH -e slurm.%j.err\n#SBATCH --mail-user=<username>@hyderabad.bits-pilani.ac.in\n#SBATCH --mail-type=ALL\nsrun apptainer exec gromacs_latest.sif sample.sh\n'})}),"\n",(0,a.jsx)(n.h3,{id:"how-can-i-use-a-gpu-in-an-apptainer-container",children:"How can I use a GPU in an Apptainer container?"}),"\n",(0,a.jsxs)(n.p,{children:["If you want to use a GPU in an Apptainer container, pass the ",(0,a.jsx)(n.code,{children:"--nv"})," flag to your ",(0,a.jsx)(n.code,{children:"apptainer"})," command."]}),"\n",(0,a.jsxs)(n.p,{children:["For example, a typical ",(0,a.jsx)(n.code,{children:"exec"})," command on a GPU container would be something like:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"$ apptainer exec --nv cuda_latest.sif my_scipt.py\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"--nv"})," flag can be passed to ",(0,a.jsx)(n.code,{children:"exec"}),", ",(0,a.jsx)(n.code,{children:"run"}),", and ",(0,a.jsx)(n.code,{children:"shell"}),"."]})}),"\n",(0,a.jsx)(n.h3,{id:"what-are-some-recommended-registry-websites-supporting-apptainer",children:"What are some recommended registry websites supporting Apptainer?"}),"\n",(0,a.jsx)(n.p,{children:"We recommend the following registry websites:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://hub.docker.com/",children:"Docker Hub"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://cloud.sylabs.io/",children:"Sylabs.io"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://biocontainers.pro/registry",children:"BioContainers"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://catalog.ngc.nvidia.com/",children:"NVIDIA GPU Cloud (NGC)"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://ghcr.io",children:"Github Container Registry"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://quay.io/",children:"Redhat Quay"})}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,r.M)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},4552:(e,n,i)=>{i.d(n,{I:()=>o,M:()=>s});var a=i(1504);const r={},t=a.createContext(r);function s(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);